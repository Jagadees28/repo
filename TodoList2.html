<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../fontawesome/css/all.css">
    <title>Document</title>
    <style>
        .card{
            border: none;
            border-radius: 6px;
        }
        button{
            border: none;
            background: none;
        }
        .hide{
            display: none;
            transition: 1s ease;
        }
        #box{
            border: none;
            outline: none;
        }
        
    </style>
</head>
<body>
    <nav class="navbar bg-primary">
        <div style="padding-left: 20px; font-weight: 200;" class="navbar-brand text-white"><i class="fa-solid fa-envelope"></i> My Task</div>
    </nav>
    <div class="container-fluid mt-5">
        <div class="row">
            <div class="col-4 mt-4  m-auto">
                <div class="card">
                    <div class="card-headrer bg-primary text-white text-center"><h5 class="mt-2">To Do List</h5></div>
                    <div class="card-body">
                        <form id="task-form">
                            <div class="form-group">
                                <input type="text" placeholder="Enter The Task" class="form-control" id="task">
                            </div>
                            <div>
                                <span class="hide" id="msg" style="color:red">Enter the Task!!!</span>
                            </div>
                            <div class="form-group">
                                <button class="btn  mt-3" id="submit"><i class="fa-solid fa-plus" style="color: green;"></i> Add</button>
                                <button class="btn float-end mt-3" id="clear"><i class="fa-solid fa-trash" style="color: red;"></i> Clear All</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid mt-5">
        <div class="row">
            <div class="col-5 mt-4  m-auto">
                <div class="card">
                    <div class="card-body">
                        <ul class="list-group" id="display">
                            
                            <!-- <li class="list-group-item list-group-item-primary mt-2">Get The Job</li> -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        let globarr=getitem();
        let submit=document.getElementById('submit');
        let display=document.getElementById('display');
        let ms=document.getElementById('msg');
        let task=document.getElementById('task');
        let clearBtn = document.getElementById('clear');
        let edit='';
        print();
        clearBtn.addEventListener('click',(e)=>{
            e.preventDefault();
            localStorage.clear();
            globarr=getitem();
            print();
        });
        function setitem(){
            localStorage.setItem('todo',JSON.stringify(globarr));
        }
        function getitem(){
            return localStorage.getItem('todo')?JSON.parse(localStorage.getItem('todo')):[];
        }
        function edititem(id){
            let find=globarr.find(item=>item.id==id)
            edit=find;
            submit.innerText="update";
            submit.classList.add('btn-danger');
            task.value=find.msg;
        }
        function del(id){
            globarr=globarr.filter(item=>item.id!=id);
            setitem();
            print();
        }
        function print()
        {
            let str='';
            globarr.map((item)=>{
                str+=`<li class="list-group-item mt-2 list-group-item-primary"><input type="checkbox" id="box" class="btn btn-outline-primary bg-green"><span>  ${item.msg}</span>
                                <button class="float-end ms-2" id="close" onclick="del(${item.id})"><i class="fa fa-circle-xmark"></i></button>
                                <button class="float-end"><i class="fa fa-pen-to-square" onclick="edititem(${item.id})"></i></button>
                            </li>`;
            })
            display.innerHTML=str;
        }
        submit.addEventListener('click',(e)=>{
            if(!task.value){
                e.preventDefault();
                ms.classList.remove('hide');
            }
            else{
                if(edit)
                {
                    globarr=globarr.map((item)=>{
                        if(item.id==edit.id)
                        {
                            let newText=task.value;
                            return{
                                ...item,msg:newText
                            }
                        }
                        else{
                            return item;
                        }
                    })
                    submit.innerText="Add";
                    submit.classList.remove('btn-danger');
                    edit=";"
                }
                else{
                    let obj={
                        id:Math.trunc(Math.random()*1000),
                        msg:task.value
                    }
                    globarr.push(obj)
                }
                print()
                task.value=""
                setitem();
            }
        })

    </script>
</body>
</html>